<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-color: #121212;  /* Color de fondo oscuro */
            color: #ffffff;  /* Color de texto claro */
            font-family: 'Arial', sans-serif;
        }

        .player-container {
            max-width: 70%;
            margin: auto;
            margin-top: 50px;
            background-color: #212121;  /* Color de fondo del contenedor */
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);  /* Sombra con color claro */
        }

        #mediaPlayer {
            display: none;
            width: 100%;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        #currentMedia, #currentTime {
            margin-bottom: 0;
            font-size: 16px;
            color: #ffffff;  /* Color de texto claro */
        }

        .title{
            color: #253bff;
        }
        .btn-group {
            margin-top: 10px;
        }

        .form-group {
            margin-top: 15px;
        }

        label {
            font-weight: bold;
            color: #ffffff;  /* Color de texto claro */
        }

        select {
            height: 150px;
            background-color: #343a40;  /* Color de fondo más oscuro para la lista de reproducción */
            color: #ffffff;  /* Color de texto claro */
        }

        /* Botones estilo dark */
        .btn-dark {
            background-color: #343a40;
            color: #ffffff;
            border: 1px solid #ffffff;
        }

        /* Botones estilo dark cuando están activos */
        .btn-dark.active, .btn-dark:active {
            background-color: #212529;
            border: 1px solid #ffffff;
        }
    </style>
    <title>Reproductor de Lista de Reproducción</title>
</head>
<body>
    <div class="container player-container">
        <h1 class="title mt-4 mb-4">Reproductor de multimedia</h1>

        <video id="mediaPlayer" controls></video>
        <p id="currentMedia" class="mt-3 mb-2">Nombre del audio/video</p>
        <p id="currentTime" class="mb-3">Tiempo actual / Duración total</p>

        <div class="btn-group" role="group">
            <button type="button" class="btn btn-primary" onclick="addMedia()">Añadir media</button>
            <button type="button" class="btn btn-primary" onclick="playPause()">Reproducir/Pausar</button>
            <button type="button" class="btn btn-primary" onclick="prevMedia()">Anterior</button>
            <button type="button" class="btn btn-primary" onclick="nextMedia()">Siguiente</button>
            <button type="button" class="btn btn-primary" onclick="toggleRandom()">Aleatorio</button>
            <!-- <button type="button" class="btn btn-primary" onclick="toggleSubtitles()">Subtítulos</button> -->
            <button type="button" class="btn btn-danger" onclick="removeMedia()">Eliminar media</button>
        </div>

        <!-- <div class="form-group mt-3">
            <label for="subtitleFile">Subtítulos:</label>
            <input type="file" class="form-control-file" id="subtitleFile">
        </div> -->

        <div class="form-group">
            <label for="playlist">Lista de reproducción:</label>
            <select class="form-control" id="playlist" multiple></select>
        </div>
    </div>


<script>
    // Lista de reproducción
    let playlist = [];
    let currentIndex = 0;
    let randomMode = false;
    let subtitlesEnabled = false;

    // Obtener elementos del DOM
    const mediaPlayer = document.getElementById('mediaPlayer');
    const currentMediaElement = document.getElementById('currentMedia');
    const currentTimeElement = document.getElementById('currentTime');
    const subtitleFileInput = document.getElementById('subtitleFile');
    const playlistSelect = document.getElementById('playlist');

    // Añadir media a la lista de reproducción
    function addMedia() {
    const fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.accept = 'audio/*,video/*';
    fileInput.onchange = function (event) {
        const file = event.target.files[0];
        if (file) {
            const listItem = document.createElement('option');
            listItem.text = file.name;

            playlist.push({ file });
            playlistSelect.add(listItem);

            if (playlist.length === 1) {
                playMedia(0);
            }
        }
    };
    fileInput.click();
}

    // Reproducir/Pausar media
    function playPause() {
        if (mediaPlayer.paused) {
            mediaPlayer.play();
        } else {
            mediaPlayer.pause();
        }
    }

    function playMedia(index) {
    currentIndex = index;
    const media = playlist[currentIndex];
    mediaPlayer.src = URL.createObjectURL(media.file);
    mediaPlayer.onloadedmetadata = function () {
        mediaPlayer.style.display = 'block';  // Mostrar el video cuando se carga
        if (subtitlesEnabled && media.subtitle) {
            const track = document.createElement('track');
            track.src = URL.createObjectURL(media.subtitle);
            track.kind = 'subtitles';
            track.srclang = 'es';
            mediaPlayer.appendChild(track);
        }
        mediaPlayer.play();
        currentMediaElement.textContent = `Now Playing: ${media.file.name}`;
        updateTime();
    };
}
    // Actualizar tiempo actual
    function updateTime() {
        currentTimeElement.textContent = `${formatTime(mediaPlayer.currentTime)} / ${formatTime(mediaPlayer.duration)}`;
    }

    // Formatear tiempo en segundos a formato mm:ss
    function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = Math.floor(seconds % 60);
        return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
    }

    // Anterior media
    function prevMedia() {
        currentIndex = (currentIndex - 1 + playlist.length) % playlist.length;
        playMedia(currentIndex);
    }

    // Siguiente media
    function nextMedia() {
        if (randomMode) {
            currentIndex = Math.floor(Math.random() * playlist.length);
        } else {
            currentIndex = (currentIndex + 1) % playlist.length;
        }
        playMedia(currentIndex);
    }

    // Activar/desactivar reproducción aleatoria
    function toggleRandom() {
        randomMode = !randomMode;
    }

    // Activar/desactivar subtítulos
    function toggleSubtitles() {
        subtitlesEnabled = !subtitlesEnabled;
        if (!subtitlesEnabled) {
            const tracks = mediaPlayer.getElementsByTagName('track');
            for (const track of tracks) {
                track.remove();
            }
        }
    }

    // Eliminar media de la lista de reproducción
    function removeMedia() {
        if (playlist.length > 0) {
            playlist.splice(currentIndex, 1);
            playlistSelect.remove(currentIndex);
            if (playlist.length > 0) {
                playMedia(currentIndex);
            } else {
                mediaPlayer.src = '';
                mediaPlayer.style.display = 'none';  // Ocultar el video cuando no hay video cargado
                currentMediaElement.textContent = 'Nombre del audio/video';
                currentTimeElement.textContent = 'Tiempo actual / Duración total';
            }
        }
    }

    // Eventos del reproductor
    mediaPlayer.addEventListener('timeupdate', updateTime);
    mediaPlayer.addEventListener('ended', nextMedia);
</script>

</body>
</html>
